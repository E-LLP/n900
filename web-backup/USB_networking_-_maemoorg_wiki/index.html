<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" dir="ltr" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

		
				<meta name="keywords" content="USB networking,N900 USB networking,Root access,USB">
		<link rel="shortcut icon" href="favicon.ico">
		<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.maemo.org/opensearch_desc.php" title="maemo.org wiki (English)">
<link rel="alternate" type="application/rss+xml" title="maemo.org wiki RSS Feed" href="http://wiki.maemo.org/index.php?title=Special:Recentchanges&amp;feed=rss">
<link rel="alternate" type="application/atom+xml" title="maemo.org wiki Atom Feed" href="http://wiki.maemo.org/index.php?title=Special:Recentchanges&amp;feed=atom">
		<title>USB networking - maemo.org wiki</title>
        
        
        <!--[if lte IE 6]>
            <link rel="stylesheet" href="http://static.maemo.org/style_maemo2009/css/ie.css" type="text/css" media="screen">
        <![endif]-->


        
        
		
		
		<meta http-equiv="imagetoolbar" content="no"><!--[endif]---->
		
		
                
		
		<!-- Head Scripts -->
		
		
		
	
<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body class="mediawiki ns-0 ltr page-USB_networking">
        <div id="container">
            <div id="header">
                <div id="logo">
                                        <a href="http://maemo.org/"><img src="logo.jpg" title="Maemo.org" alt="Maemo.org"></a>
                </div><!-- logo -->

	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="http://wiki.maemo.org/index.php?title=Special:Userlogin&amp;returnto=USB_networking" title="You are encouraged to log in, it is not mandatory however. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
            </div>
        </div>
            <div id="navigation">
                <div id="navigation-left-wrapper">

                    <div id="navigation-right-wrapper">

                        <ul>
                            <li><a href="http://maemo.org/intro/">Intro</a></li>
                            <li><a href="http://maemo.org/downloads/">Downloads</a></li>
                            <li class="selected"><a href="http://maemo.org/community/">Community</a></li>
                            <li><a href="http://maemo.org/development/">Development</a></li>
                            <li><a href="http://maemo.org/news/">News</a></li>
                            <li><a href="http://talk.maemo.org/">TALK</a></li>
                        </ul>


		<div id="search">
			<form action="http://wiki.maemo.org/Special:Search" id="searchform">
				<input id="searchInput" name="search" title="Search maemo.org wiki [f]" accesskey="f" value="" type="text">
				<input name="go" class="submit" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists" type="submit">&nbsp;
<!--				<input type='submit' name="fulltext" class="submit" id="mw-searchButton" value="Go" title="Search the pages for this text" /> &nbsp; -->
			</form>
		</div>


                    </div>
                </div>
            </div><!-- /navigation -->
            <div id="breadcrumb"></div>
            <div id="content">
                        

<!--	<div id="globalWrapper">
		<div id="column-content">
	<div id="content2"> 


		<a name="top" id="top"></a>
				<h1 class="firstHeading">USB networking</h1>
		<div id="bodyContent">
-->

      
<!-- sidebar --> 
                  <div id="sidebar">
		<div id="nav-sub">

		<div class="portlet" id="p-navigation">
		<h3>Navigation</h3>
			<ul>
				<li id="n-mainpage"><a href="http://wiki.maemo.org/Main_Page" title="Visit the Main Page [z]" accesskey="z">Main Page</a></li>
				<li id="n-recentchanges"><a href="http://wiki.maemo.org/Special:Recentchanges" title="The list of recent changes in the wiki. [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="http://wiki.maemo.org/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="http://wiki.maemo.org/Help:Contents" title="The place to find out.">Help</a></li>
				<li id="n-advancedsearch"><a href="http://wiki.maemo.org/Special:Search">Advanced search</a></li>
			</ul>
	</div>
	


	<div id="p-cactions" class="portlet">
		<h3>Views</h3>
			<ul class="fi_protie_navigation">
					 <li id="ca-nstab-main" class="selected"><a href="http://wiki.maemo.org/USB_networking" title="View the content page [c]" accesskey="c">Page</a></li>
					 <li id="ca-talk"><a href="http://wiki.maemo.org/Talk:USB_networking" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
					 <li id="ca-edit"><a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit" title="You can edit this page. Please use the preview button before saving. [e]" accesskey="e">Edit</a></li>
					 <li id="ca-history"><a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=history" title="Past versions of this page. [h]" accesskey="h">History</a></li>
				</ul>
	</div>


    
		</div>

               </div>
<!-- sidebar --> 
<div id="main">
<div id="main-wrapper">

			            <h1 class="firstHeading">USB networking</h1>
			<!-- start content -->
			<p>This page describes how the maemo platform can be turned into a <a href="http://wiki.maemo.org/USB" title="USB">USB</a> network device. The first part describes how to configure the Nokia tablet as a USB pluggable network device. The second part describes how to configure various platforms to use the Nokia tablet as a network device. This article is based loosely on the Maemo 3.x <a href="http://maemo.org/development/documentation/manuals/3-x/howto_usb_networking_bora/" class="external text" title="http://maemo.org/development/documentation/manuals/3-x/howto_usb_networking_bora/" rel="nofollow">configuring USB networking HOWTO</a>.
</p><p>You might want to use the tablet as a USB network device to log into your tablet remotely, or to transfer data from your tablet to another computer, in a situation where wifi or bluetooth are not an option. If you wish to connect your tablet to a Linux machine over TCP/IP, the <a href="http://maemo.org/development/documentation/pc_connectivity/" class="external text" title="http://maemo.org/development/documentation/pc_connectivity/" rel="nofollow">PC connectivity</a> section in the Maemo SDK documentation also contains useful information.
</p><p><b>WARNING</b>
Currently there is a bug in the g_ether.ko driver of OS2008 (both 4.0.1 and 4.1) which prevents USB networking from working correctly with Windows machines (but not with Linux machines). See <a href="https://bugs.maemo.org/show_bug.cgi?id=3243" class="external text" title="https://bugs.maemo.org/show_bug.cgi?id=3243" rel="nofollow">bug #3243</a> for details. The bug was introduced somewhere between kernels 2.6.18 and 2.6.21, so Maemo versions based on 2.6.18 kernels (e.g. OS2007 and earlier) will work.
</p>
<table id="toc" class="toc" summary="Contents"><tbody><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#USB_networking_for_N900"><span class="tocnumber">1</span> <span class="toctext">USB networking for N900</span></a></li>
<li class="toclevel-1"><a href="#Tablet_USB_network_configuration"><span class="tocnumber">2</span> <span class="toctext">Tablet USB network configuration</span></a>
<ul>
<li class="toclevel-2"><a href="#USB_statusbar_plugin"><span class="tocnumber">2.1</span> <span class="toctext">USB statusbar plugin</span></a></li>
<li class="toclevel-2"><a href="#Behind_the_scenes"><span class="tocnumber">2.2</span> <span class="toctext">Behind the scenes</span></a></li>
<li class="toclevel-2"><a href="#Starting_and_stopping_USB_network_mode"><span class="tocnumber">2.3</span> <span class="toctext">Starting and stopping USB network mode</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Host_USB_Network_Configuration"><span class="tocnumber">3</span> <span class="toctext">Host USB Network Configuration</span></a>
<ul>
<li class="toclevel-2"><a href="#Windows"><span class="tocnumber">3.1</span> <span class="toctext">Windows</span></a>
<ul>
<li class="toclevel-3"><a href="#Requirements"><span class="tocnumber">3.1.1</span> <span class="toctext">Requirements</span></a></li>
<li class="toclevel-3"><a href="#Preparing_the_Windows_host"><span class="tocnumber">3.1.2</span> <span class="toctext">Preparing the Windows host</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Linux"><span class="tocnumber">3.2</span> <span class="toctext">Linux</span></a>
<ul>
<li class="toclevel-3"><a href="#Kernel_Configuration"><span class="tocnumber">3.2.1</span> <span class="toctext">Kernel Configuration</span></a></li>
<li class="toclevel-3"><a href="#NetworkManager_based"><span class="tocnumber">3.2.2</span> <span class="toctext">NetworkManager based</span></a></li>
<li class="toclevel-3"><a href="#Fedora"><span class="tocnumber">3.2.3</span> <span class="toctext">Fedora</span></a></li>
<li class="toclevel-3"><a href="#Debian"><span class="tocnumber">3.2.4</span> <span class="toctext">Debian</span></a></li>
<li class="toclevel-3"><a href="#Configuring_the_host_as_a_gateway"><span class="tocnumber">3.2.5</span> <span class="toctext">Configuring the host as a gateway</span></a></li>
<li class="toclevel-3"><a href="#Configuring_the_host_as_a_bridge"><span class="tocnumber">3.2.6</span> <span class="toctext">Configuring the host as a bridge</span></a></li>
<li class="toclevel-3"><a href="#Configuring_the_host_firewall"><span class="tocnumber">3.2.7</span> <span class="toctext">Configuring the host firewall</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Testing_the_connection"><span class="tocnumber">3.3</span> <span class="toctext">Testing the connection</span></a></li>
<li class="toclevel-2"><a href="#Known_issues"><span class="tocnumber">3.4</span> <span class="toctext">Known issues</span></a></li>
<li class="toclevel-2"><a href="#Frequently_asked_questions"><span class="tocnumber">3.5</span> <span class="toctext">Frequently asked questions</span></a></li>
</ul>
</li>
</ul>
</td></tr></tbody></table>
<a name="USB_networking_for_N900"></a><h2><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=1" title="Edit section: USB networking for N900">edit</a>]</span> <span class="mw-headline"> USB networking for N900 </span></h2>
<p>Please visit <a href="http://wiki.maemo.org/N900_USB_networking" title="N900 USB networking">N900 USB networking</a>.
</p>
<a name="Tablet_USB_network_configuration"></a><h2><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=2" title="Edit section: Tablet USB network configuration">edit</a>]</span> <span class="mw-headline"> Tablet USB network configuration </span></h2>
<a name="USB_statusbar_plugin"></a><h3><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=3" title="Edit section: USB statusbar plugin">edit</a>]</span> <span class="mw-headline"> USB statusbar plugin </span></h3>
<p>The <a href="http://garage.maemo.org/projects/usb-otg-plugin/" class="external text" title="http://garage.maemo.org/projects/usb-otg-plugin/" rel="nofollow">usb-otg-plugin</a> applet lets you set up USB networking tablet-side, and switch between host and client mode. This is the easy way to do things and no other tablet-side configuration is required.
</p><p>Alternatively you could try the usb networking applet found here:
</p>
<pre> <a href="http://repository.maemo.org/extras-devel/pool/diablo/free/m/maemo-control/" class="external free" title="http://repository.maemo.org/extras-devel/pool/diablo/free/m/maemo-control/" rel="nofollow">http://repository.maemo.org/extras-devel/pool/diablo/free/m/maemo-control/</a>
</pre>
<a name="Behind_the_scenes"></a><h3><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=4" title="Edit section: Behind the scenes">edit</a>]</span> <span class="mw-headline"> Behind the scenes </span></h3>
<p>In normal circumstances, the USB Mass storage driver had control of the USB hardware. USBNet allows the g_ether network driver to take control of the USB interface.
</p><p>After installing USB networking, set up a dummy access point by running the following:
</p>
<pre>gconftool-2 -s -t string /system/osso/connectivity/IAP/DUMMY/type DUMMY
gconftool-2 -s -t string /system/osso/connectivity/IAP/DUMMY/name 'Dummy network'
gconftool-2 -s -t boolean /system/osso/connectivity/IAP/DUMMY/autoconnect true
</pre>
<p>You should see a "DEFAULT" connection appear in the connection manager.
</p><p><b>WARNING</b>
Currently there is a bug in Diablo that causes DUMMY connections not to show up in connection manager, a semi-official fix is outlined in <a href="https://bugs.maemo.org/show_bug.cgi?id=3306#c23" class="external text" title="https://bugs.maemo.org/show_bug.cgi?id=3306#c23" rel="nofollow">bug #3306</a>.
</p>
<a name="Starting_and_stopping_USB_network_mode"></a><h3><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=5" title="Edit section: Starting and stopping USB network mode">edit</a>]</span> <span class="mw-headline"> Starting and stopping USB network mode </span></h3>
<p>To easily start &amp; stop USB network mode, place the following script in /etc/init.d/usbnet on your tablet. To do this, you will need <a href="http://wiki.maemo.org/Root_access" title="Root access">root access</a> to the device.
</p><p>While switching between modes by running the script, it is important to disconnect the USB cable.
</p>
<pre>#! /bin/sh
#
# Startup script for USBnet (networking, instead of USB Mass Storage behaviour)
# Author: Michael Mlivoncic

PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
NAME=usbnet
DESC="USB Networking for Nokia Internet Tablets"
INITFILE=/etc/init.d/$NAME

case "$1" in
start)
        umount /media/mmc1
        umount /media/mmc2
        sleep 2
        USBNET="`lsmod | grep g_ether`"
        KERNEL_VERSION="`uname -r`"
        if [ "$USBNET" = "" ]
        then
           echo "Entering Ethernet via USB mode (g_ether)..."
           insmod /mnt/initfs/lib/modules/$KERNEL_VERSION/g_ether.ko
           echo "Waiting, then bringing up the usb0 interface.."
           sleep 1
           /sbin/ifup usb0
        else
          echo "Already in Ethernet-via-USB mode..."
          echo "Try ping 192.168.2.15"
        fi
       &nbsp;;;
stop)
         echo "switching back to USB Mass Storage mode..."
         echo "removing module g_ether"
         /sbin/ifdown usb0
         sleep 2
         rmmod g_ether
       &nbsp;;;
*)
        printf "Usage: $INITFILE {start|stop}\n" &gt;&amp;2
        exit 1
       &nbsp;;;
esac

exit 0
</pre>
<p>The script needs to have executable permissions, which you can give with 
</p>
<pre>sudo chmod a+x /etc/init.d/usbnet
</pre>
<p>The script is quite basic, but can be run automatically at start-up, or manually using the command:
</p>
<pre>sudo /etc/init.d/usbnet [start|stop]
</pre>
<p>to activate or deactivate USB networking.
</p><p>There is a default USB network interface configuration on Nokia N800 and 770 tablets. In the file /etc/network/interfaces, you should see a section which looks like this:
</p>
<pre>auto usb0
iface usb0 inet static
       address 192.168.2.15
       netmask 255.255.255.0
       gateway 192.168.2.14
</pre>
<p>With this default configuration, the tablet interface will have the IP address 192.168.2.15, and the remote end will have the IP address 192.168.2.14.
</p>
<a name="Host_USB_Network_Configuration"></a><h2><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=6" title="Edit section: Host USB Network Configuration">edit</a>]</span> <span class="mw-headline"> Host USB Network Configuration </span></h2>
<a name="Windows"></a><h3><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=7" title="Edit section: Windows">edit</a>]</span> <span class="mw-headline"> Windows </span></h3>
<a name="Requirements"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=8" title="Edit section: Requirements">edit</a>]</span> <span class="mw-headline">Requirements</span></h4>
<ul><li> For Windows 2000, you will need to download [ RNDIS drivers] from Microsoft.
</li><li> Download the file "Nokia770 USB Ethernet RNDIS.inf" from <a href="http://homepage.hispeed.ch/mlivoncic/Nokia770%20USB%20Ethernet%20RNDIS.inf" class="external text" title="http://homepage.hispeed.ch/mlivoncic/Nokia770%20USB%20Ethernet%20RNDIS.inf" rel="nofollow">here</a> or <a href="http://homepage.sunrise.ch/mysunrise/mlivoncic/Nokia770%20USB%20Ethernet%20RNDIS.inf" class="external text" title="http://homepage.sunrise.ch/mysunrise/mlivoncic/Nokia770%20USB%20Ethernet%20RNDIS.inf" rel="nofollow">here</a>. This allows to recognise that the RNDIS driver can be used with the Nokia device, and other Linux USB devices.
</li><li> <a href="http://appcheck.net.temp.realssl.com/storage/Nokia900%20USB%20Ethernet%20RNDIS.inf" class="external text" title="http://appcheck.net.temp.realssl.com/storage/Nokia900%20USB%20Ethernet%20RNDIS.inf" rel="nofollow">Here</a> is an updated inf that should work on newer (32 or 64) bit Windows. It's not really tested much so please report results on the talk page!
</li><li> If you are using an N800, skip all the steps below which apply to the N770; the bora distribution supplies a control panel applet called "maemo-statusbar-usbnet". Once installed, the control panel "Maemo-DM" will allow you to change the function of the USB port from "MMC emulation" to a RNDIS emulation of a USB ethernet interface. You will also need to set the WinXP side's IP address to be fixed at 192.168.2.14.
</li></ul>
<a name="Preparing_the_Windows_host"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=9" title="Edit section: Preparing the Windows host">edit</a>]</span> <span class="mw-headline"> Preparing the Windows host </span></h4>
<p>On Windows 2000, dowload &amp; unpack RNDIS-USB-Kit_05.exe <a href="http://www.microsoft.com/whdc/device/network/NDIS/rndis.mspx" class="external text" title="http://www.microsoft.com/whdc/device/network/NDIS/rndis.mspx" rel="nofollow">on the Microsoft web site</a>. You need to copy rndismpy.sys (30 KB) and usb8023y.sys (14 KB) from 
</p>
<pre>RNDIS USB kit 2005\Drivers\x86fre\sys files
</pre>
<p>to a folder of your choice, e.g. c:\Drivers\Nokia770_RNDIS. Add "Nokia770 USB Ethernet RNDIS.inf" to the same folder; this will complete your driver set.
</p><p>When you connect the Nokia to the PC, it will look for a suitable driver. As opposed to the USB mass device mode, Windows will not find a suitable driver by default. Windows supports so-called RNDIS devices, but it does not know that the N770 will act as such. Therefore, we need to instruct it to do so: In the driver dialog, provide the driver's location. Point it to the directory where you previously downloaded the "Nokia770 USB Ethernet RNDIS.inf" (or linux.inf) file. It will show you a driver called <i>Linux USB Ethernet/RNDIS Gadget</i>. Install it.
</p><p>A new network card with this name will become visible afterwards, which you can configure normally. Set the IP address to 192.168.2.14. Optionally activate ICS (Internet Connection Sharing) on your network adapter to share the outside world with your little Nokia.
</p>
<a name="Linux"></a><h3><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=10" title="Edit section: Linux">edit</a>]</span> <span class="mw-headline"> Linux </span></h3>
<a name="Kernel_Configuration"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=11" title="Edit section: Kernel Configuration">edit</a>]</span> <span class="mw-headline"> Kernel Configuration </span></h4>
<p>You should have the usbnet module available for your Linux kernel. On most distributions, this is the case by default. If this is not the case for your distribution, you will need to enable USB networking support in the kernel.
If you build your own kernel then you want 'CDC Ethernet support' in USB Network adaptors.
</p>
<pre>#
# USB Network Adapters
#
...
CONFIG_USB_USBNET=m
...
CONFIG_USB_NET_CDCETHER=m
...
</pre>
<a name="NetworkManager_based"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=12" title="Edit section: NetworkManager based">edit</a>]</span> <span class="mw-headline"> NetworkManager based </span></h4>
<p>A recent NetworkManager (at in least Fedora 12 and Ubuntu Karmic Koala) supports Ethernet USB gadgets out-of-the-box. However the 'auto usb0' entry that it creates amongst your connection list is configured for DHCP and the tablet will not provide that, so it will time out.
</p><p>The easiest/cleanest way to get it to work is probably to create a new connection using the same MAC address as 'auto usb0' has, and then providing a fixed IP address: 192.168.2.14/255.255.255.0 for example, or change settings on the connection created by network-manager.
</p>
<a name="Fedora"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=13" title="Edit section: Fedora">edit</a>]</span> <span class="mw-headline"> Fedora </span></h4>
<p>Older Fedora versions also supports Ethernet USB gadgets out-of-the-box. To configure the USB networking:
</p>
<ul><li> Connect the tablet with g_ether.ko loaded to your Linux PC
</li><li> Open System -&gt; Administrate -&gt; Network (or run system-config-network from command line).
</li><li> Press the "New" button to create a new network interface. Select "Ethernet" network card type.
</li><li> On the next screen, select the "Netchip Technology, Inc. Linux-USB Ethernet/RNDIS Gadget (usb0)" or "Nokia Mobile Phones N900 (PC-Suite Mode)".
</li><li> Choose "Static IP address" and enter the IP address 192.168.2.15 for your PC, if you are using the default usb0 configuration on your tablet. Don't fill the gateway field on the Fedora side.
</li><li> Fill other settings (DNS etc) if you want to, then press "Finish".
</li></ul>
<p>Now reconnect the tablet to PC and the interface should automatically configure.
</p>
<a name="Debian"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=14" title="Edit section: Debian">edit</a>]</span> <span class="mw-headline"> Debian </span></h4>
<p>Ensure that the usbnet module is available to your kernel (try <i>modprobe usbnet</i>, then <i>lsmod</i> to check).
</p><p>Add the following to /etc/network/interfaces:
</p>
<pre>allow-hotplug usb0

mapping hotplug
        script grep
        map usb0

iface usb0 inet static
       address 192.168.2.14
       netmask 255.255.255.0
       broadcast 192.168.2.255
       up iptables -I INPUT 1 -s 192.168.2.15 -j ACCEPT
</pre>
<p>After plugging in the tablet, you can bring up the network interface with the command <i>ifup usb0</i>.
</p>
<a name="Configuring_the_host_as_a_gateway"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=15" title="Edit section: Configuring the host as a gateway">edit</a>]</span> <span class="mw-headline"> Configuring the host as a gateway </span></h4>
<p>If your host has no firewalling rules, you can set the gateway rules by modifying /etc/interfaces file.
</p>
<pre>iface usb0 inet static
        address 192.168.2.14
        netmask 255.255.255.0
        up echo 1 &gt; /proc/sys/net/ipv4/ip_forward
        up iptables -P FORWARD ACCEPT
        up iptables -A POSTROUTING -t nat -j MASQUERADE -s 192.168.2.0/24
        down echo 0 &gt; /proc/sys/net/ipv4/ip_forward
        down iptables -t nat -F POSTROUTING
</pre>
<p>Else add the necessary MASQUERADE rules to normal firewall rules.
</p><p>If you get the following error:
</p>
<pre>iptables v1.2.11: can't initialize iptables table `NAT': Table does not exist (do you need to insmod?)
Perhaps iptables or your kernel needs to be upgraded.
</pre>
<p>You need verify that your kernel has the relevant iptables modules included, and hotplug or udev is set up properly on your computer.
</p>
<a name="Configuring_the_host_as_a_bridge"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=16" title="Edit section: Configuring the host as a bridge">edit</a>]</span> <span class="mw-headline"> Configuring the host as a bridge </span></h4>
<p>Normally eth0 is on dhcp. This configuration allows my tablet to be on the same LAN as the rest of my boxes. You need the <b>bridge</b> module for 802.1d Ethernet Bridging installed.
</p>
<pre>iface br0 inet dhcp
         hostname ash
         pre-up   echo     "Adding ethernet bridge between LAN and PAN"
         pre-up   ifconfig eth0 0.0.0.0
         pre-up   brctl    addbr br3
         pre-up   brctl    setfd br3 0
         pre-up   brctl    stp br3 off
         pre-up   brctl    addif br3 eth0         
         pre-down echo     "Removing ethernet bridge between LAN and PAN"
         post-down brctl    delif br3 eth0
         post-down brctl    delbr br3
         post-down ifdown eth0
         post-down ifup eth0
</pre>
<p>I do
</p>
<pre> ifup br0
</pre>
<p>And the tablet is then on the LAN.
</p>
<a name="Configuring_the_host_firewall"></a><h4><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=17" title="Edit section: Configuring the host firewall">edit</a>]</span> <span class="mw-headline"> Configuring the host firewall </span></h4>
<p>If you have your Linux host configured with a strict firewall, you may need to modify your iptables to allow the tablet to access the internet over USB networking.
</p><p>To allow access both to &amp; from the tablet, the following iptables rules are required:
</p>
<pre> iptables -A OUTPUT -o usb0 -j ACCEPT
 iptables -A INPUT -i usb0 -j ACCEPT
</pre>
<a name="Testing_the_connection"></a><h3><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=18" title="Edit section: Testing the connection">edit</a>]</span> <span class="mw-headline"> Testing the connection </span></h3>
<p>To test the connection, you can either type <i>ping 192.168.2.15</i> on your PC or <i>ping 192.168.2.14</i> in an xterm on your tablet.
</p><p>For troubleshooting, use <i>ifconfig -a</i> and <i>route</i> to verify on the Nokia and on a Linux or Unix PC, and <i>ipconfig /all</i> and <i>route print</i> on Windows.
</p>
<a name="Known_issues"></a><h3><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=19" title="Edit section: Known issues">edit</a>]</span> <span class="mw-headline"> Known issues </span></h3>
<p>When unplugging and replugging the USB cable between the two devices, Windows will indicate a code 10-error indicating that the device could not start properly. The problem appears to be with the Nokia tablet, since after rebooting the device, networking works again. Remember to first initialize g_ether before plugging your tablet into the USB host.
</p><p>This seems to be the case with Ubuntu too. Replugging causes following messages appear in the kernel log:
</p>
<pre>[182104.412082] usb 3-1: new full speed USB device using uhci_hcd and address 29
[182104.824071] usb 3-1: device not accepting address 29, error -71
[182104.824100] hub 3-0:1.0: unable to enumerate USB device on port 1
</pre>
<p>Rebooting the tablet seems to work.
</p>
<a name="Frequently_asked_questions"></a><h3><span class="editsection">[<a href="http://wiki.maemo.org/index.php?title=USB_networking&amp;action=edit&amp;section=20" title="Edit section: Frequently asked questions">edit</a>]</span> <span class="mw-headline"> Frequently asked questions </span></h3>
<ol><li> So if we have already plugged in our 770 into XP, and it recognized it as a drive, do we need to remove the driver software that makes it appear as a USB drive, and replace it with the USBNet drivers? 
<ul><li> No, windows registers the tablet in network mode as a different device. 
</li><li> However, as stated above: you have to insmod the kernel module on your tablet before you connect the cable!
</li></ul>
</li><li> When I try to do the above, I get an error stating that the driver I am trying to choose doesn't have anything to do with my hardware.
<ul><li> Make sure you have activated USB networking on the Nokia side correctly.
</li></ul>
</li><li> My tablet can now talk to my XP machine, but how do I get out to the rest of the network?
<dl><dd>First, set up a dummy access point, as described above, so that you can configure the network settings in connection manager for your usbnet connection. This will allow you to configure proxy server access. Secondly, install a proxy on your local machine. Examples include <a href="http://www.proxomitron.info/" class="external text" title="http://www.proxomitron.info/" rel="nofollow">proxomitron</a> or <a href="http://www.handcraftedsoftware.org/" class="external text" title="http://www.handcraftedsoftware.org/" rel="nofollow">freeproxy</a>.
</dd></dl>
</li><li> How do I set up DNS once I have connected the tablet and the host?
<ul><li> Install and configure pdnsd on your host computer, and add nameserver 192.168.2.14 to the file /etc/resolv.conf on your tablet.
</li><li> or configure the host as a gateway, and use the same DNS servers as your host (without messing up /etc/resolv.conf and the dnsmasq server):
</li></ul>
<dl><dd><dl><dd>echo "nameserver xxx.xxx.xxx.xxx" &gt;&gt; /tmp/resolv.conf.ppp0 
</dd><dd>where xxx.xxx.xxx.xxx is the dns server of the host (  as found in /etc/resolv.conf on the host linux box )
</dd><dd>echo again the second address if required.
</dd><dd>Don't forget to choose "dummy" from the wireless connection manager on the tablet and do 'ifup usb0' on the Linux box.
</dd></dl>
</dd></dl>
</li><li>How do I keep my SD memory cards from being unmounted?
<ul><li> Before you plug in the usb cable; open two xterminals and cd one to /media/mmc1 and the other to /media/mmc2 and leave them there. By keeping a foot in the door the cards are kept available ... the usbnet will still succeed.
</li></ul>
</li></ol>

<!-- 
NewPP limit report
Preprocessor node count: 42/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
#ifexist count: 0/100
-->

<!-- Saved in parser cache with key mediawiki-mw_:pcache:idhash:108-0!1!0!!en!2 and timestamp 20120702181455 -->
<div class="printfooter">
Retrieved from "<a href="http://wiki.maemo.org/USB_networking">http://wiki.maemo.org/USB_networking</a>"</div>
			<div id="catlinks"><p class="catlinks"><a href="http://wiki.maemo.org/Special:Categories" title="Special:Categories">Categories</a>: <span dir="ltr"><a href="http://wiki.maemo.org/Category:Users" title="Category:Users">Users</a></span> | <span dir="ltr"><a href="http://wiki.maemo.org/Category:Wiki_page_of_the_day" title="Category:Wiki page of the day">Wiki page of the day</a></span> | <span dir="ltr"><a href="http://wiki.maemo.org/Category:Connectivity" title="Category:Connectivity">Connectivity</a></span> | <span dir="ltr"><a href="http://wiki.maemo.org/Category:USB" title="Category:USB">USB</a></span> | <span dir="ltr"><a href="http://wiki.maemo.org/Category:Power_users" title="Category:Power users">Power users</a></span></p></div>
			<!-- end content -->



                    </div><!-- /main-wrapper -->
                </div><!-- /main --><!-- content end -->

			<div class="visualClear"></div>

        <ul style="clear: left; float: left; display: inline; list-style-type: none;">
<li id="lastmod"> This page was last modified 20:29, 21 August 2010.</li><li id="viewcount">This page has been accessed 90,104 times.</li>      </ul>
			<div class="visualClear"></div>


			<div id="footer">
                <div id="footer-wrapper-left">
                    <div id="footer-wrapper-right">

			<ul>
                                <li class="first"><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">All Content CC</a></li>
                <li><a href="http://maemo.org/legal/">Legal</a></li>
                				<li class="privacy"><a href="http://wiki.maemo.org/maemo.org_wiki:Privacy_policy" title="maemo.org wiki:Privacy policy">Privacy policy</a></li>
				<li class="about"><a href="http://wiki.maemo.org/maemo.org_wiki:About" title="maemo.org wiki:About">About maemo.org wiki</a></li>
                <li>Powered by <a href="http://www.mediawiki.org/">MediaWiki</a></li>
			</ul>
                    </div>
                </div>
		</div>
		
	
		
</div>
<!-- Served in 0.287 secs. -->

        </div><!-- container -->

    

</body>
</html>
